<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;datum&#x2F;tgui_say - byond</title>
</head>
<body>
<header>
    <a href="index.html">byond</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="datum/tgui_say.html#var">Var Details</a> - <a href="datum/tgui_say.html#proc">Proc Details</a></header>
<main>
<h1>tgui_say <aside>/<a href="datum.html">datum</a>/<a href="datum/tgui_say.html">tgui_say</a></aside>
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L23">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 23"/></a></h1>

<p>The tgui say modal. This initializes an input window which hides until
the user presses one of the speech hotkeys. Once something is entered, it will
delegate the speech to the proper channel.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="datum/tgui_say.html#var/client">client</a></th><td>The user who opened the window</td></tr>
            <tr><th><a href="datum/tgui_say.html#var/hurt_phrases">hurt_phrases</a></th><td>Injury phrases to blurt out</td></tr>
            <tr><th><a href="datum/tgui_say.html#var/max_length">max_length</a></th><td>Max message length</td></tr>
            <tr><th><a href="datum/tgui_say.html#var/window">window</a></th><td>The modal window</td></tr>
            <tr><th><a href="datum/tgui_say.html#var/window_open">window_open</a></th><td>Boolean for whether the tgui_say was opened by the user.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/New">New</a></th><td>Creates the new input window to exist in the background.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/alter_entry">alter_entry</a></th><td>Alters text when players are injured.
Adds text, trims left and right side</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/close">close</a></th><td>Closes the window serverside. Closes any open chat bubbles
regardless of preference. Logs the event.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/delegate_speech">delegate_speech</a></th><td>No OOC leaks
Random trimming for larger sentences
Otherwise limit trim to just last letter
Delegates the speech to the proper channel.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/force_say">force_say</a></th><td>Force say handler.
Sends a message to the say modal to send its current value.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/handle_entry">handle_entry</a></th><td>Handles text entry and forced speech.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/initialize">initialize</a></th><td>After a brief period, injects the scripts into
the window to listen for open commands.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/load">load</a></th><td>Ensures nothing funny is going on window load.
Minimizes the window, sets max length, closes all
typing and thinking indicators. This is triggered
as soon as the window sends the &quot;ready&quot; message.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/on_message">on_message</a></th><td>The equivalent of ui_act, this waits on messages from the window
and delegates actions.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/open">open</a></th><td>Sets the window as &quot;opened&quot; server side, though it is already
visible to the user. We do this to set local vars &amp;
start typing (if enabled and in an IC channel). Logs the event.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/start_thinking">start_thinking</a></th><td>Sets the mob as &quot;thinking&quot; - with indicator and the TRAIT_THINKING_IN_CHARACTER trait</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/start_typing">start_typing</a></th><td>Handles the user typing. After a brief period of inactivity,
signals the client mob to revert to the &quot;thinking&quot; icon.</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/stop_thinking">stop_thinking</a></th><td>Removes typing/thinking indicators and flags the mob as not thinking</td></tr>
            <tr><th><a href="datum/tgui_say.html#proc/stop_typing">stop_typing</a></th><td>Remove the typing indicator after a brief period of inactivity or during say events.
If the user was typing IC, the thinking indicator is shown.</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/client"><aside class="declaration">var </aside>client
            <aside>&ndash; /<a href="client.html">client</a></aside>
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L25">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 25"/></a></h3>
        <p>The user who opened the window</p><h3 id="var/hurt_phrases"><aside class="declaration">var </aside>hurt_phrases
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L27">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 27"/></a></h3>
        <p>Injury phrases to blurt out</p><h3 id="var/max_length"><aside class="declaration">var </aside>max_length
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L29">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 29"/></a></h3>
        <p>Max message length</p><h3 id="var/window"><aside class="declaration">var </aside>window
            <aside>&ndash; /<a href="datum.html">datum</a>/<a href="datum/tgui_window.html">tgui_window</a></aside>
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L31">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 31"/></a></h3>
        <p>The modal window</p><h3 id="var/window_open"><aside class="declaration">var </aside>window_open
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L35">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 35"/></a></h3>
        <p>Boolean for whether the tgui_say was opened by the user.</p><h2 id="proc">Proc Details</h2><h3 id="proc/New">New<aside>(/<a href="client.html">client</a>/client, id) 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L36">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 36"/></a></aside>
        </h3>
        <p>Creates the new input window to exist in the background.</p><h3 id="proc/alter_entry"><aside class="declaration">proc </aside>alter_entry<aside>(payload) 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/speech.dm#L10">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;speech.dm 10"/></a></aside>
        </h3>
        <p>Alters text when players are injured.
Adds text, trims left and right side</p>
<p>Arguments:
payload - a string list containing entry &amp; channel
Returns:
string - the altered entry</p><h3 id="proc/close"><aside class="declaration">proc </aside>close<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L100">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 100"/></a></aside>
        </h3>
        <p>Closes the window serverside. Closes any open chat bubbles
regardless of preference. Logs the event.</p><h3 id="proc/delegate_speech"><aside class="declaration">proc </aside>delegate_speech<aside>(entry, channel) 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/speech.dm#L33">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;speech.dm 33"/></a></aside>
        </h3>
        <p>No OOC leaks
Random trimming for larger sentences
Otherwise limit trim to just last letter
Delegates the speech to the proper channel.</p>
<p>Arguments:
entry - the text to broadcast
channel - the channel to broadcast in
Returns:
boolean - on success or failure</p><h3 id="proc/force_say"><aside class="declaration">proc </aside>force_say<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/speech.dm#L68">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;speech.dm 68"/></a></aside>
        </h3>
        <p>Force say handler.
Sends a message to the say modal to send its current value.</p><h3 id="proc/handle_entry"><aside class="declaration">proc </aside>handle_entry<aside>(type, payload) 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/speech.dm#L94">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;speech.dm 94"/></a></aside>
        </h3>
        <p>Handles text entry and forced speech.</p>
<p>Arguments:
type - a string &quot;entry&quot; or &quot;force&quot; based on how this function is called
payload - a string list containing entry &amp; channel
Returns:
boolean - success or failure</p><h3 id="proc/initialize"><aside class="declaration">proc </aside>initialize<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L47">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 47"/></a></aside>
        </h3>
        <p>After a brief period, injects the scripts into
the window to listen for open commands.</p><h3 id="proc/load"><aside class="declaration">proc </aside>load<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L64">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 64"/></a></aside>
        </h3>
        <p>Ensures nothing funny is going on window load.
Minimizes the window, sets max length, closes all
typing and thinking indicators. This is triggered
as soon as the window sends the &quot;ready&quot; message.</p><h3 id="proc/on_message"><aside class="declaration">proc </aside>on_message<aside>(type, payload) 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L110">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 110"/></a></aside>
        </h3>
        <p>The equivalent of ui_act, this waits on messages from the window
and delegates actions.</p><h3 id="proc/open"><aside class="declaration">proc </aside>open<aside>(payload) 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/modal.dm#L86">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;modal.dm 86"/></a></aside>
        </h3>
        <p>Sets the window as &quot;opened&quot; server side, though it is already
visible to the user. We do this to set local vars &amp;
start typing (if enabled and in an IC channel). Logs the event.</p>
<p>Arguments:
payload - A list containing the channel the window was opened in.</p><h3 id="proc/start_thinking"><aside class="declaration">proc </aside>start_thinking<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/typing.dm#L26">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;typing.dm 26"/></a></aside>
        </h3>
        <p>Sets the mob as &quot;thinking&quot; - with indicator and the TRAIT_THINKING_IN_CHARACTER trait</p><h3 id="proc/start_typing"><aside class="declaration">proc </aside>start_typing<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/typing.dm#L39">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;typing.dm 39"/></a></aside>
        </h3>
        <p>Handles the user typing. After a brief period of inactivity,
signals the client mob to revert to the &quot;thinking&quot; icon.</p><h3 id="proc/stop_thinking"><aside class="declaration">proc </aside>stop_thinking<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/typing.dm#L32">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;typing.dm 32"/></a></aside>
        </h3>
        <p>Removes typing/thinking indicators and flags the mob as not thinking</p><h3 id="proc/stop_typing"><aside class="declaration">proc </aside>stop_typing<aside>() 
        
    
            <a href="https://github.com/tgstation/TerraGov-Marine-Corps/blob/bfeaf60f069b9d753b339afccdc0b16b13f5cff1/code/modules/tgui_input/say_modal/typing.dm#L48">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;tgui_input&#x2F;say_modal&#x2F;typing.dm 48"/></a></aside>
        </h3>
        <p>Remove the typing indicator after a brief period of inactivity or during say events.
If the user was typing IC, the thinking indicator is shown.</p></main>
<footer>
    tgmc.dme
    <a href="https://github.com/tgstation/TerraGov-Marine-Corps/tree/bfeaf60f069b9d753b339afccdc0b16b13f5cff1">bfeaf60</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.8.0</a></footer>
</body>
</html>
